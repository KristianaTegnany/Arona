{"version":3,"sources":["../node_modules/browserify-aes/ghash.js"],"names":["Buffer","require","ZEROES","buf","out","GHASH","i","block","Vi","toArray","Zi","xi","lsbVi","j","fromArray","chunk","module"],"mappings":"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","sourcesContent":["var Buffer = require('safe-buffer').Buffer\nvar ZEROES = Buffer.alloc(16, 0)\n\nfunction toArray (buf) {\n  return [\n    buf.readUInt32BE(0),\n    buf.readUInt32BE(4),\n    buf.readUInt32BE(8),\n    buf.readUInt32BE(12)\n  ]\n}\n\nfunction fromArray (out) {\n  var buf = Buffer.allocUnsafe(16)\n  buf.writeUInt32BE(out[0] >>> 0, 0)\n  buf.writeUInt32BE(out[1] >>> 0, 4)\n  buf.writeUInt32BE(out[2] >>> 0, 8)\n  buf.writeUInt32BE(out[3] >>> 0, 12)\n  return buf\n}\n\nfunction GHASH (key) {\n  this.h = key\n  this.state = Buffer.alloc(16, 0)\n  this.cache = Buffer.allocUnsafe(0)\n}\n\n// from http://bitwiseshiftleft.github.io/sjcl/doc/symbols/src/core_gcm.js.html\n// by Juho Vähä-Herttua\nGHASH.prototype.ghash = function (block) {\n  var i = -1\n  while (++i < block.length) {\n    this.state[i] ^= block[i]\n  }\n  this._multiply()\n}\n\nGHASH.prototype._multiply = function () {\n  var Vi = toArray(this.h)\n  var Zi = [0, 0, 0, 0]\n  var j, xi, lsbVi\n  var i = -1\n  while (++i < 128) {\n    xi = (this.state[~~(i / 8)] & (1 << (7 - (i % 8)))) !== 0\n    if (xi) {\n      // Z_i+1 = Z_i ^ V_i\n      Zi[0] ^= Vi[0]\n      Zi[1] ^= Vi[1]\n      Zi[2] ^= Vi[2]\n      Zi[3] ^= Vi[3]\n    }\n\n    // Store the value of LSB(V_i)\n    lsbVi = (Vi[3] & 1) !== 0\n\n    // V_i+1 = V_i >> 1\n    for (j = 3; j > 0; j--) {\n      Vi[j] = (Vi[j] >>> 1) | ((Vi[j - 1] & 1) << 31)\n    }\n    Vi[0] = Vi[0] >>> 1\n\n    // If LSB(V_i) is 1, V_i+1 = (V_i >> 1) ^ R\n    if (lsbVi) {\n      Vi[0] = Vi[0] ^ (0xe1 << 24)\n    }\n  }\n  this.state = fromArray(Zi)\n}\n\nGHASH.prototype.update = function (buf) {\n  this.cache = Buffer.concat([this.cache, buf])\n  var chunk\n  while (this.cache.length >= 16) {\n    chunk = this.cache.slice(0, 16)\n    this.cache = this.cache.slice(16)\n    this.ghash(chunk)\n  }\n}\n\nGHASH.prototype.final = function (abl, bl) {\n  if (this.cache.length) {\n    this.ghash(Buffer.concat([this.cache, ZEROES], 16))\n  }\n\n  this.ghash(fromArray([0, abl, 0, bl]))\n  return this.state\n}\n\nmodule.exports = GHASH\n"],"file":"ghash.js"}