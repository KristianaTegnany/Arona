{"version":3,"sources":["../node_modules/aws4/lru.js"],"names":["module","size","Object","LruCache","node","DoublyLinkedList","lastNode"],"mappings":"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","sourcesContent":["module.exports = function(size) {\n  return new LruCache(size)\n}\n\nfunction LruCache(size) {\n  this.capacity = size | 0\n  this.map = Object.create(null)\n  this.list = new DoublyLinkedList()\n}\n\nLruCache.prototype.get = function(key) {\n  var node = this.map[key]\n  if (node == null) return undefined\n  this.used(node)\n  return node.val\n}\n\nLruCache.prototype.set = function(key, val) {\n  var node = this.map[key]\n  if (node != null) {\n    node.val = val\n  } else {\n    if (!this.capacity) this.prune()\n    if (!this.capacity) return false\n    node = new DoublyLinkedNode(key, val)\n    this.map[key] = node\n    this.capacity--\n  }\n  this.used(node)\n  return true\n}\n\nLruCache.prototype.used = function(node) {\n  this.list.moveToFront(node)\n}\n\nLruCache.prototype.prune = function() {\n  var node = this.list.pop()\n  if (node != null) {\n    delete this.map[node.key]\n    this.capacity++\n  }\n}\n\n\nfunction DoublyLinkedList() {\n  this.firstNode = null\n  this.lastNode = null\n}\n\nDoublyLinkedList.prototype.moveToFront = function(node) {\n  if (this.firstNode == node) return\n\n  this.remove(node)\n\n  if (this.firstNode == null) {\n    this.firstNode = node\n    this.lastNode = node\n    node.prev = null\n    node.next = null\n  } else {\n    node.prev = null\n    node.next = this.firstNode\n    node.next.prev = node\n    this.firstNode = node\n  }\n}\n\nDoublyLinkedList.prototype.pop = function() {\n  var lastNode = this.lastNode\n  if (lastNode != null) {\n    this.remove(lastNode)\n  }\n  return lastNode\n}\n\nDoublyLinkedList.prototype.remove = function(node) {\n  if (this.firstNode == node) {\n    this.firstNode = node.next\n  } else if (node.prev != null) {\n    node.prev.next = node.next\n  }\n  if (this.lastNode == node) {\n    this.lastNode = node.prev\n  } else if (node.next != null) {\n    node.next.prev = node.prev\n  }\n}\n\n\nfunction DoublyLinkedNode(key, val) {\n  this.key = key\n  this.val = val\n  this.prev = null\n  this.next = null\n}\n"],"file":"lru.js"}