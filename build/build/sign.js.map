{"version":3,"sources":["../node_modules/jsonwebtoken/sign.js"],"names":["timespan","require","PS_SUPPORTED","jws","includes","isBoolean","isInteger","isNumber","isPlainObject","isString","once","SUPPORTED_ALGS","sign_options_schema","expiresIn","isValid","message","notBefore","audience","Array","algorithm","header","encoding","issuer","subject","jwtid","noTimestamp","keyid","mutatePayload","registered_claims_schema","iat","exp","nbf","Object","validator","schema","object","validate","options_to_payload","options_for_objects","module","callback","options","isObjectPayload","Buffer","alg","typ","kid","failure","validatePayload","payload","invalid_options","validateOptions","timestamp","Math","Date","claim","privateKey","secret"],"mappings":"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","sourcesContent":["var timespan = require('./lib/timespan');\nvar PS_SUPPORTED = require('./lib/psSupported');\nvar jws = require('jws');\nvar includes = require('lodash.includes');\nvar isBoolean = require('lodash.isboolean');\nvar isInteger = require('lodash.isinteger');\nvar isNumber = require('lodash.isnumber');\nvar isPlainObject = require('lodash.isplainobject');\nvar isString = require('lodash.isstring');\nvar once = require('lodash.once');\n\nvar SUPPORTED_ALGS = ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'none']\nif (PS_SUPPORTED) {\n  SUPPORTED_ALGS.splice(3, 0, 'PS256', 'PS384', 'PS512');\n}\n\nvar sign_options_schema = {\n  expiresIn: { isValid: function(value) { return isInteger(value) || (isString(value) && value); }, message: '\"expiresIn\" should be a number of seconds or string representing a timespan' },\n  notBefore: { isValid: function(value) { return isInteger(value) || (isString(value) && value); }, message: '\"notBefore\" should be a number of seconds or string representing a timespan' },\n  audience: { isValid: function(value) { return isString(value) || Array.isArray(value); }, message: '\"audience\" must be a string or array' },\n  algorithm: { isValid: includes.bind(null, SUPPORTED_ALGS), message: '\"algorithm\" must be a valid string enum value' },\n  header: { isValid: isPlainObject, message: '\"header\" must be an object' },\n  encoding: { isValid: isString, message: '\"encoding\" must be a string' },\n  issuer: { isValid: isString, message: '\"issuer\" must be a string' },\n  subject: { isValid: isString, message: '\"subject\" must be a string' },\n  jwtid: { isValid: isString, message: '\"jwtid\" must be a string' },\n  noTimestamp: { isValid: isBoolean, message: '\"noTimestamp\" must be a boolean' },\n  keyid: { isValid: isString, message: '\"keyid\" must be a string' },\n  mutatePayload: { isValid: isBoolean, message: '\"mutatePayload\" must be a boolean' }\n};\n\nvar registered_claims_schema = {\n  iat: { isValid: isNumber, message: '\"iat\" should be a number of seconds' },\n  exp: { isValid: isNumber, message: '\"exp\" should be a number of seconds' },\n  nbf: { isValid: isNumber, message: '\"nbf\" should be a number of seconds' }\n};\n\nfunction validate(schema, allowUnknown, object, parameterName) {\n  if (!isPlainObject(object)) {\n    throw new Error('Expected \"' + parameterName + '\" to be a plain object.');\n  }\n  Object.keys(object)\n    .forEach(function(key) {\n      var validator = schema[key];\n      if (!validator) {\n        if (!allowUnknown) {\n          throw new Error('\"' + key + '\" is not allowed in \"' + parameterName + '\"');\n        }\n        return;\n      }\n      if (!validator.isValid(object[key])) {\n        throw new Error(validator.message);\n      }\n    });\n}\n\nfunction validateOptions(options) {\n  return validate(sign_options_schema, false, options, 'options');\n}\n\nfunction validatePayload(payload) {\n  return validate(registered_claims_schema, true, payload, 'payload');\n}\n\nvar options_to_payload = {\n  'audience': 'aud',\n  'issuer': 'iss',\n  'subject': 'sub',\n  'jwtid': 'jti'\n};\n\nvar options_for_objects = [\n  'expiresIn',\n  'notBefore',\n  'noTimestamp',\n  'audience',\n  'issuer',\n  'subject',\n  'jwtid',\n];\n\nmodule.exports = function (payload, secretOrPrivateKey, options, callback) {\n  if (typeof options === 'function') {\n    callback = options;\n    options = {};\n  } else {\n    options = options || {};\n  }\n\n  var isObjectPayload = typeof payload === 'object' &&\n                        !Buffer.isBuffer(payload);\n\n  var header = Object.assign({\n    alg: options.algorithm || 'HS256',\n    typ: isObjectPayload ? 'JWT' : undefined,\n    kid: options.keyid\n  }, options.header);\n\n  function failure(err) {\n    if (callback) {\n      return callback(err);\n    }\n    throw err;\n  }\n\n  if (!secretOrPrivateKey && options.algorithm !== 'none') {\n    return failure(new Error('secretOrPrivateKey must have a value'));\n  }\n\n  if (typeof payload === 'undefined') {\n    return failure(new Error('payload is required'));\n  } else if (isObjectPayload) {\n    try {\n      validatePayload(payload);\n    }\n    catch (error) {\n      return failure(error);\n    }\n    if (!options.mutatePayload) {\n      payload = Object.assign({},payload);\n    }\n  } else {\n    var invalid_options = options_for_objects.filter(function (opt) {\n      return typeof options[opt] !== 'undefined';\n    });\n\n    if (invalid_options.length > 0) {\n      return failure(new Error('invalid ' + invalid_options.join(',') + ' option for ' + (typeof payload ) + ' payload'));\n    }\n  }\n\n  if (typeof payload.exp !== 'undefined' && typeof options.expiresIn !== 'undefined') {\n    return failure(new Error('Bad \"options.expiresIn\" option the payload already has an \"exp\" property.'));\n  }\n\n  if (typeof payload.nbf !== 'undefined' && typeof options.notBefore !== 'undefined') {\n    return failure(new Error('Bad \"options.notBefore\" option the payload already has an \"nbf\" property.'));\n  }\n\n  try {\n    validateOptions(options);\n  }\n  catch (error) {\n    return failure(error);\n  }\n\n  var timestamp = payload.iat || Math.floor(Date.now() / 1000);\n\n  if (options.noTimestamp) {\n    delete payload.iat;\n  } else if (isObjectPayload) {\n    payload.iat = timestamp;\n  }\n\n  if (typeof options.notBefore !== 'undefined') {\n    try {\n      payload.nbf = timespan(options.notBefore, timestamp);\n    }\n    catch (err) {\n      return failure(err);\n    }\n    if (typeof payload.nbf === 'undefined') {\n      return failure(new Error('\"notBefore\" should be a number of seconds or string representing a timespan eg: \"1d\", \"20h\", 60'));\n    }\n  }\n\n  if (typeof options.expiresIn !== 'undefined' && typeof payload === 'object') {\n    try {\n      payload.exp = timespan(options.expiresIn, timestamp);\n    }\n    catch (err) {\n      return failure(err);\n    }\n    if (typeof payload.exp === 'undefined') {\n      return failure(new Error('\"expiresIn\" should be a number of seconds or string representing a timespan eg: \"1d\", \"20h\", 60'));\n    }\n  }\n\n  Object.keys(options_to_payload).forEach(function (key) {\n    var claim = options_to_payload[key];\n    if (typeof options[key] !== 'undefined') {\n      if (typeof payload[claim] !== 'undefined') {\n        return failure(new Error('Bad \"options.' + key + '\" option. The payload already has an \"' + claim + '\" property.'));\n      }\n      payload[claim] = options[key];\n    }\n  });\n\n  var encoding = options.encoding || 'utf8';\n\n  if (typeof callback === 'function') {\n    callback = callback && once(callback);\n\n    jws.createSign({\n      header: header,\n      privateKey: secretOrPrivateKey,\n      payload: payload,\n      encoding: encoding\n    }).once('error', callback)\n      .once('done', function (signature) {\n        callback(null, signature);\n      });\n  } else {\n    return jws.sign({header: header, payload: payload, secret: secretOrPrivateKey, encoding: encoding});\n  }\n};\n"],"file":"sign.js"}