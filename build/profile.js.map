{"version":3,"sources":["../node_modules/memoizee/profile.js"],"names":["partial","require","forEach","pad","compact","d","memoize","max","Math","stats","exports","statistics","Object","defineProperty","conf","id","source","data","stack","Error","split","slice","some","line","indexOf","replace","trim","call","profileName","join","initial","cached","on","log","ordered","ipad","cpad","ppad","toPrc","initialCount","cachedCount","toFixed","name","push","nameA","nameB","String","length"],"mappings":"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","sourcesContent":["// Gathers statistical data, and provides them in convinient form\n\n\"use strict\";\n\nvar partial = require(\"es5-ext/function/#/partial\")\n  , forEach = require(\"es5-ext/object/for-each\")\n  , pad     = require(\"es5-ext/string/#/pad\")\n  , compact = require(\"es5-ext/array/#/compact\")\n  , d       = require(\"d\")\n  , memoize = require(\"./plain\");\n\nvar max = Math.max, stats = exports.statistics = {};\n\nObject.defineProperty(\n\tmemoize,\n\t\"__profiler__\",\n\td(function (conf) {\n\t\tvar id, source, data, stack;\n\t\tstack = new Error().stack;\n\t\tif (\n\t\t\t!stack ||\n\t\t\t!stack.split(\"\\n\").slice(3).some(function (line) {\n\t\t\t\tif (line.indexOf(\"/memoizee/\") === -1 && line.indexOf(\" (native)\") === -1) {\n\t\t\t\t\tsource = line.replace(/\\n/g, \"\\\\n\").trim();\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t})\n\t\t) {\n\t\t\tsource = \"unknown\";\n\t\t}\n\t\tid = compact.call([conf.profileName, source]).join(\", \");\n\n\t\tif (!stats[id]) stats[id] = { initial: 0, cached: 0 };\n\t\tdata = stats[id];\n\n\t\tconf.on(\"set\", function () { ++data.initial; });\n\t\tconf.on(\"get\", function () { ++data.cached; });\n\t})\n);\n\nexports.log = function () {\n\tvar initial, cached, ordered, ipad, cpad, ppad, toPrc, log;\n\n\tinitial = cached = 0;\n\tordered = [];\n\n\ttoPrc = function (initialCount, cachedCount) {\n\t\tif (!initialCount && !cachedCount) {\n\t\t\treturn \"0.00\";\n\t\t}\n\t\treturn ((cachedCount / (initialCount + cachedCount)) * 100).toFixed(2);\n\t};\n\n\tlog = \"------------------------------------------------------------\\n\";\n\tlog += \"Memoize statistics:\\n\\n\";\n\n\tforEach(\n\t\tstats,\n\t\tfunction (data, name) {\n\t\t\tinitial += data.initial;\n\t\t\tcached += data.cached;\n\t\t\tordered.push([name, data]);\n\t\t},\n\t\tnull,\n\t\tfunction (nameA, nameB) {\n\t\t\treturn (\n\t\t\t\tthis[nameB].initial +\n\t\t\t\tthis[nameB].cached -\n\t\t\t\t(this[nameA].initial + this[nameA].cached)\n\t\t\t);\n\t\t}\n\t);\n\n\tipad = partial.call(pad, \" \", max(String(initial).length, \"Init\".length));\n\tcpad = partial.call(pad, \" \", max(String(cached).length, \"Cache\".length));\n\tppad = partial.call(pad, \" \", \"%Cache\".length);\n\tlog +=\n\t\tipad.call(\"Init\") +\n\t\t\"  \" +\n\t\tcpad.call(\"Cache\") +\n\t\t\"  \" +\n\t\tppad.call(\"%Cache\") +\n\t\t\"  Source location\\n\";\n\tlog +=\n\t\tipad.call(initial) +\n\t\t\"  \" +\n\t\tcpad.call(cached) +\n\t\t\"  \" +\n\t\tppad.call(toPrc(initial, cached)) +\n\t\t\"  (all)\\n\";\n\tordered.forEach(function (data) {\n\t\tvar name = data[0];\n\t\tdata = data[1];\n\t\tlog +=\n\t\t\tipad.call(data.initial) +\n\t\t\t\"  \" +\n\t\t\tcpad.call(data.cached) +\n\t\t\t\"  \" +\n\t\t\tppad.call(toPrc(data.initial, data.cached)) +\n\t\t\t\"  \" +\n\t\t\tname +\n\t\t\t\"\\n\";\n\t});\n\tlog += \"------------------------------------------------------------\\n\";\n\treturn log;\n};\n"],"file":"profile.js"}